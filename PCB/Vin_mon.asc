Version 4
SHEET 1 3136 1344
WIRE 192 96 -32 96
WIRE 320 96 192 96
WIRE -32 112 -32 96
WIRE 192 128 192 96
WIRE -32 208 -32 192
WIRE 320 208 320 96
WIRE 192 224 192 208
WIRE 272 224 192 224
WIRE 192 368 192 224
WIRE 320 400 320 384
WIRE 448 400 320 400
WIRE 624 400 448 400
WIRE 736 400 624 400
WIRE -192 416 -304 416
WIRE 32 416 -112 416
WIRE 128 416 32 416
WIRE 320 416 320 400
WIRE 448 416 448 400
WIRE 624 432 624 400
WIRE -304 448 -304 416
WIRE 32 448 32 416
WIRE 320 512 320 496
WIRE 448 512 448 480
WIRE 624 512 624 496
WIRE -304 544 -304 528
WIRE 32 544 32 528
WIRE 192 544 192 464
FLAG 32 544 0
FLAG 192 544 0
FLAG -304 544 0
FLAG -32 208 0
FLAG 736 400 Vin_mon
FLAG 448 512 0
FLAG 624 512 0
FLAG 320 512 0
FLAG -304 416 PSU_en
FLAG -32 96 Vin
SYMBOL res 176 112 R0
SYMATTR InstName R1
SYMATTR Value 100k
SYMBOL voltage -32 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -304 432 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -208 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 4k7
SYMBOL res 16 432 R0
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL pmos 272 304 M180
SYMATTR InstName M2
SYMATTR Value BSS84
SYMBOL npn 128 368 R0
SYMATTR InstName Q1
SYMATTR Value BC847B
SYMBOL cap 432 416 R0
SYMATTR InstName C1
SYMATTR Value 10n
SYMBOL zener 640 496 R180
WINDOW 0 -34 61 Left 2
WINDOW 3 -153 -8 Left 2
SYMATTR InstName D1
SYMATTR Value KDZVTF3_6B
SYMATTR Prefix X
SYMBOL res 304 288 R0
SYMATTR InstName R2
SYMATTR Value 6k8
SYMBOL res 304 400 R0
SYMATTR InstName R6
SYMATTR Value 1k1
TEXT -274 256 Left 2 !.dc V1 0 40 0.1
TEXT 944 -248 Left 2 !* KDZVTF3_6B D model\n* Model Generated by ROHM\n* All Rights Reserved\n* Commercial Use or Resale Restricted\n* Date: 2015/09/08\n*******************A C\n.SUBCKT KDZVTF3_6B 1 2\n.PARAM T0=25\n.FUNC I1(V) {IF(V<0,-1.564E-07*((-V*(1+6.172E-04*(TEMP-T0)+1.165E-13*(TEMP-T0)**2))**0.932E+01+\n+           (-V*(1+3.172E-04*(TEMP-T0)+1.165E-13*(TEMP-T0)**2))**6.964E+00),0)}\nR1 1 2 1E15\nE1 3 0 VALUE={V(1,2)}\nV1 3 4 0\nD1 4 0 D1\nV2 3 5 0\nD2 5 0 D2\nG1 1 2 VALUE={I1(V(3))+I(V1)-I(V2)*IF(V(3)<0,1,0)}\n.MODEL D1 D\n+ IS=3.3290E-15\n+ N=.98962\n+ RS=4.3701E-3\n+ IKF=.36806\n+ CJO=1.3050E-9\n+ M=.27519\n+ VJ=.54271\n+ ISR=8.425E-11\n+ NR=4.0900\n+ BV=4.6000\n+ IBV=10.000\n+ TT=7.2140E-8\n+ NBV=0.5000\n+ NBVL=2.5000\n+ IBVL=1.0000\n.MODEL D2 D\n+ IS=3.3290E-15\n+ N=.98962\n+ RS=4.3701E-3\n+ IKF=.36806\n+ M=.27519\n+ VJ=.54271\n.ENDS
TEXT -274 292 Left 2 ;.tran 5m startup
TEXT -272 336 Left 2 ;TODO: select transistors
TEXT -752 784 Left 2 ;https://electronics.stackexchange.com/questions/546121/placement-of-mosfets-in-switchable-voltage-divider-for-voltage-measurements
